# Stage 3. Обучающая программа для стажера-программиста в компании «Firecode». Этап 3. PHP.

На третьем этапе необходимо изучить основы PHP. Первые 2 дня - изучение материала. На оставшиеся 8 дней будет дано практическое задание, охватывающее материал, представленный в этом файле. По выполнению задания необходимо скинуть архив сайта вместе с дампом БД руководителю для проверки.
Как только руководителя устроит выполненное задание, будет дан тест на проверку полученных знаний. При успешном написании теста перейдем к четвертому этапу - закрепление PHP и командная разработка с помощью Git.

## Материал для подготовки ##

Основной материал стоит брать с официальной документации по PHP  В обязательном порядке изучить следующие вопросы:

*Изолирование от HTML*
*Разделение инструкций*
*Комментарии*
*Арифметические операторы*
*Оператор присваивания*
*Побитовые операторы*
*Операторы сравнения*
*Оператор управления ошибками*
*Операторы исполнения*
*Операторы инкремента и декремента*
*Логические операторы*
*Строковые операторы*
*Операторы, работающие с массивами*
*Оператор проверки типа*
*Приоритет оператора*
*Переменные. Основы*
*Предопределенные переменные*

**Суперглобальные переменные**
**$_GLOBALS**
**$_SERVER**
**$_GET**
**$_POST**
**$_FILES**
**$_COOKIE**
**$_SESSION**
**$_REQUEST**
**$_ENV**

**Область видимости переменной**
**Переменные переменных**
**Переменные извне PHP**
**Функции, определяемые пользователем**
**Аргументы функции**
**Возврат значений**
**Встроенные функции**
**Анонимные функции**
**Конструкция if**
**Конструкция else**
**Конструкция elseif**
**Альтернативный синтаксис управляющих структур**

**Циклы**
*for*
*while*
*do while*
*foreach*

**Конструкции включений**
*include*
*require*
*include_once*
*require_once*

**Конструкция возврата значений**
**Конструкция выбора**
**Конструкция объявления**

**Типы данных**
*boolean*
*integer*
*float*
*string*
*array*
*object*
*resource*
*NULL*

*Константы*
*Управление сессиями*
*Cookies*

**Серверная валидация**
*trim*
*htmlspecialchars*
*mysqli_real_escape_string*
*filter_var*
*stripslashes*
*strip_tags*

**Что такое Google reCAPTCHA**

**Основы ООП**

**Паттерны**

*Паттерн Singleton*
*Паттерн MVC*

**JSON**

**Что такое PSR**


## Практическая часть ##

В практической части продолжаем работу с версткой из первой части.

## Вот само задание ##  *(потом подправлю)*

Дорабатываем калькулятор, созданный на этапе изучения верстки и Java Script (Stage 1). 
Проект теперь будет делиться на публичную часть и административную часть. В публичной части остается всё то, что было сделано на 1-ом этапе, в админской части (можно в корне сайта сделать папку admin и хранить все необходимые файлы там) будет реализован новый функционал. 

Необходимо проделать следующие работы: 

1. Создание структуры БД. 
Необходимо создать 3 таблицы в БД. Столбцы должны быть обязательно на анлгийском языке (никаких Пароль, parol, Parol, par не должно быть). 
- Таблица users - тут будут храниться логины и хэши паролей пользователей для входа в административную панель сайта. 
Поля: 
- - Индентификатор; 
- - Логин; 
- - Пароль. 
- Таблица settings - тут будут храниться настройки для калькулятора. 
Поля: 
- - Идентификатор; 
- - Цена за кв.м. потолка; 
- - Цена светильников; 
- - Цена люстр; 
- - Цена труб; 
- - Цена углов; 
- - Цена при установки галочки “Глянцевая фактура”; 
- - Цена при установки галочки “Матовая фактура”; 
- - Варианты цвета (формат - текст, будет храниться JSON строка). 
- Таблица requests - тут будут храниться заявки пользователей. 
Поля: 
- - Идентификатор; 
- - Город доставки; 
- - Дата рождения; 
- - Телефон; 
- - Текст заявки (это поле будет содержать в себе итоговую цену и все настройки, которые вбил пользователь в калькуляторе);
- - Дата заявки; 
- - IP пользователя. 

2. Создание административной панели. 
Необходимо создать дополнительную страницу авторизации (auth.php). При переходе на неё должна отображаться форма (макет “Форма авторизации” расположен ниже задания), в которой необходимо ввести логин и пароль для доступа к странице. Если данные введены неверно (проверка будет проходить по таблице users), то сообщать, что данные неверны и доступ к странице запрещен (можно сообщать либо в самой форме авторизации подписью снизу, либо дополнительным всплывающим окном). Если данные введены верно, то сначала в сессии (или в куках) сохраняем информацию о том, что данный пользователь смог авторизоваться на сайте, и редиректим на страницу административной панели (admin.php), которая изображена на макете “Административная панель”. 
Важно: 
сразу при переходе на страницу admin.php должна быть проверка, верно ли авторизовался пользователь на странице auth.php и если авторизация не прошла, то отправлять его обратно на страницу auth.php. 
Админка будет состоять из 3-х разделов (для тестового задания все они будут на одной странице. Но правильнее это будет разнести на разные страницы). 
1-ый раздел - Пользователи. 
Тут будет список всех пользователей сайта с возможностью удалять, редактировать и добавлять новых пользователей. При нажатии на кнопку редактирования (зеленый карандаш) должна всплывать формочка с заполненным инпутом “Логин” и пустым инпутом “Пароль” с возможностью поменять это значение. К паролю должна быть приписка “Если Вы оставите пароль пустым, то для пользователя останется его предыдущий пароль”. Можно визуализировать это по другому - при клике на кнопку редактирования заполнять и изменять нижнюю форму (форму добавления). При редактировании и добавлении нового пользователя необходимо проверять следующую информацию: - существует ли пользователь с таким логином (2 пользователя с одинаковым логином существовать не могут) - пароль должен быть не менее 4-х символов 
2-ой раздел - Настройки калькулятора. 
Тут будет возможность устанавливать настройки калькулятора. При загрузке страницы текущие данные должны сразу отображаться в инпутах. Обратите внимание, что поле “Варианты цвета” будет содержать динамическое количество элементов. В БД всё это должно храниться в одном поле. Реализовать это необходимо с помощью JSON формата. 
3-ий раздел - Просмотр заявок. 
Тут можно будет просмотреть список всех заявок и удалить ненужные. Все даты обязательно должны быть в российском формате (16:05:30 22.02.2019). Обратите внимание, что в шапке админки отображается приветствие текущего пользователя и возможность выйти. 
При клике на кнопку “Выйти” должно происходить следующее: 
- удаляться информация в сессиях (куках) о том, что пользователь был авторизован; 
- перекидывать на страницу с формой авторизации (auth.php). 

3. Доработка публичной части. Каждый раз, когда пользователь вводит какие-то данные в калькулятор (изменяет значения инпутов, переключает фактуру), необходимо отправлять AJAX-запрос, передавая всю введенную информацию. В результате выполнения AJAX файла необходимо просчитать всё по формуле и отдать просто итоговую цену. Формула расчета итоговой цены: Итоговая цена = (Цена за кв.м. потолка * количество с инпута * (глянцевая или матовая фактура)) + (Цена светильников * количество) + + (Цена люстр * количество) + (Цена труб * количество) + (Цена углов * количество), где все цены тянутся с БД и настраиваются в административной панели. Важно: цвет в публичной части должен тянуться из админской части “Варианты цвета”. При клике на “Оставить заявку” вся информация должна сохраняться в БД и отправляться на почту администратору (при локальной разработке на OpenServer письма будут падать в папку temp/email в txt форматах). 
Совет. 
С чего стоит начать: 
- Создать структуру БД; 
- Сверстать страницу административной панели (admin.php); 
- Реализуем соединение с БД в отдельном классе (db.class.php) с применением паттерна Singleton; 
- Создаем класс для пользователей User (файл должен быть user.class.php); 
- Реализуем в нем первый статичный метод GetAllUsers, в котором будет происходить соединение с БД, отправляться запрос на получение всех пользователей, из запроса в массив получать результат и возвращать этот сформированный массив; 
- Реализовать первый блок “Пользователи”. А именно вывести с использованием метода класса Users (GetAllUsers) таблицу пользователей (предварительно добавив пару тестовых записей в таблицу users). 
Обязательные ребования по заданию. 
1. Соединение с базой данных должно быть реализовано через Singleton 
2. Вся реализации должна быть на ООП (оперировать классами, статическими методами)